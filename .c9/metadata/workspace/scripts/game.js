{"changed":true,"filter":false,"title":"game.js","tooltip":"/scripts/game.js","value":"/**\n * Utils\n */\n\nfunction setAttributes(model, options) {\n\t_.extend(model, options)\n}\n\n/**\n * Animal\n */\n\nfunction Animal(defaults, options) {\n\toptions = _.extend(defaults, options);\n\tsetAttributes(this, options);\n}\n\nAnimal.prototype.addClass = function(className) {\n\t$('#' + this.getId()).addClass(className || '');\n};\n\nAnimal.prototype.removeClass = function(className) {\n\t$('#' + this.getId()).removeClass(className || '');\n};\n\nAnimal.prototype.manageClasses = function(options) {\n\tthis.addClass(options.add);\n\tthis.removeClass(options.remove);\n};\n\nAnimal.prototype.setElement = function() {\n\tconsole.log(\"this.getId in setElement\", this.getId);\n\tvar html = '<div id=\"' + this.getId() + '\" class=\"' + this.initialCssClass + '\">' +\n\t\t(this.innerElements  || '') +\n\t\t'</div>';\n\t$('#canvas').append(html);\n};\n\nAnimal.prototype.getId = function() {\n\treturn (this.idBase + String(this.index));\n};\n\nAnimal.prototype.element = function() {\n\treturn $('#' + this.getId());\n}\n\n/**\n * Unicorn\n */\n\nfunction Unicorn(options) {\n\tvar defaults = {\n\t\tx: 0,\n\t\ty: 0,\n\t\tdirection: 1, // 1: right, -1: left\n\t\tinitialCssClass: 'unicorn',\n\t\tindex: Counter.incrementCount('Unicorn'),\n\t\tidBase: 'unicorn-',\n\t\tinnerElements: '<div id=\"fire\"></div>',\n\t\tisFiring: false\n\t};\n\tAnimal.call(this, defaults, options);\n\tthis.setElement();\n}\n\nUnicorn.prototype = new Animal();\n\nUnicorn.prototype.fire = function fire() {\n\tif (!this.isFiring) {\n\t\tvar $elem = this.element().find('#fire');\n\t\t$elem.removeClass('firing');\n\t\t$elem.addClass('firing');\n\t\tthis.isFiring = true;\n\t\tvar that = this;\n\t\tsetTimeout(function() {\n\t\t\t$elem.removeClass('firing');\n\t\t\tthat.isFiring = false;\n\t\t}, 700);\n\t}\n}\n\n/**\n *  Koala\n */\n\nfunction Koala(options) {\n\tvar defaults = {\n\t\tx: 0,\n\t\ty: 0,\n\t\tinitialCssClass: 'koala',\n\t\tindex: Counter.incrementCount('Koala'),\n\t\tidBase: 'koala-'\n\t};\n\tAnimal.call(this, defaults, options)\n\tthis.setElement();\t\n}\n\nKoala.prototype = new Animal();\n\n/**\n * Counter\n */\n\nvar Counter = (function() {\n\tvar list = {};\n\treturn {\n\t\tincrementCount: function incrementCount(model) {\n\t\t\tif (list[model]) {\n\t\t\t\treturn list[model];\n\t\t\t} else {\n\t\t\t\tlist[model] = 1;\n\t\t\t\treturn list[model];\n\t\t\t}\n\t\t},\n\t\tgetCount: function incrementCount(model) {\n\t\t\treturn (list[model] || 0);\n\t\t}\n\t}\n})();\n\n/**\n * Runtime\n */\n\n$(document).ready(function() {\n\tvar myUnicorn = new Unicorn({\n\t\tinitialCssClass: 'unicorn'\n\t});\n\n\tvar myKoala = new Koala({\n\t\tinitialCssClass: 'koala walking'\n\t});\n\n\t$(document).keydown(function (event) {\n\t\tswitch(event.which) {\n\t\t\tcase 39: // right arrow\n\t\t\t\tmyUnicorn.manageClasses({\n\t\t\t\t\tadd: 'walking',\n\t\t\t\t\tremove: 'reverse'\n\t\t\t\t});\n\t\t\t\tmyUnicorn.direction = 1;\n\t\t\t\tbreak;\n\t\t\tcase 37: // left arrow\n\t\t\t\tmyUnicorn.manageClasses({\n\t\t\t\t\tadd: 'reverse walking'\n\t\t\t\t});\n\t\t\t\tmyUnicorn.direction = -1;\n\t\t\t\tbreak;\n\t\t\tcase 70: // f, or 'fire'\n\t\t\t\tmyUnicorn.fire();\n\t\t\t\tbreak;\n\t\t}\n \t});\n\n\t$(document).keyup(function (event) {\n\t\tswitch(event.which) {\n\t\t\tcase 39:\n\t\t\t\tmyUnicorn.manageClasses({\n\t\t\t\t\tremove: 'walking'\n\t\t\t\t});\n\t\t\t\tbreak;\n\t\t\tcase 37:\n\t\t\t\tmyUnicorn.manageClasses({\n\t\t\t\t\tremove: 'walking'\n\t\t\t\t});\n\t\t\t\tbreak;\n\t\t}\n \t});\n\n});","undoManager":{"mark":0,"position":17,"stack":[[{"group":"doc","deltas":[{"start":{"row":169,"column":3},"end":{"row":170,"column":0},"action":"remove","lines":["",""]}]}],[{"group":"doc","deltas":[{"start":{"row":149,"column":4},"end":{"row":149,"column":21},"action":"remove","lines":["myUnicorn.fire();"]}]}],[{"group":"doc","deltas":[{"start":{"row":149,"column":3},"end":{"row":149,"column":4},"action":"remove","lines":["\t"]}]}],[{"group":"doc","deltas":[{"start":{"row":149,"column":2},"end":{"row":149,"column":3},"action":"remove","lines":["\t"]}]}],[{"group":"doc","deltas":[{"start":{"row":149,"column":1},"end":{"row":149,"column":2},"action":"remove","lines":["\t"]}]}],[{"group":"doc","deltas":[{"start":{"row":149,"column":0},"end":{"row":149,"column":1},"action":"remove","lines":["\t"]}]}],[{"group":"doc","deltas":[{"start":{"row":148,"column":27},"end":{"row":149,"column":0},"action":"remove","lines":["",""]}]}],[{"group":"doc","deltas":[{"start":{"row":146,"column":29},"end":{"row":147,"column":0},"action":"insert","lines":["",""]},{"start":{"row":147,"column":0},"end":{"row":147,"column":4},"action":"insert","lines":["\t\t\t\t"]}]}],[{"group":"doc","deltas":[{"start":{"row":147,"column":4},"end":{"row":147,"column":21},"action":"insert","lines":["myUnicorn.fire();"]}]}],[{"group":"doc","deltas":[{"start":{"row":147,"column":4},"end":{"row":147,"column":21},"action":"remove","lines":["myUnicorn.fire();"]}]}],[{"group":"doc","deltas":[{"start":{"row":147,"column":3},"end":{"row":147,"column":4},"action":"remove","lines":["\t"]}]}],[{"group":"doc","deltas":[{"start":{"row":147,"column":2},"end":{"row":147,"column":3},"action":"remove","lines":["\t"]}]}],[{"group":"doc","deltas":[{"start":{"row":147,"column":1},"end":{"row":147,"column":2},"action":"remove","lines":["\t"]}]}],[{"group":"doc","deltas":[{"start":{"row":147,"column":0},"end":{"row":147,"column":1},"action":"remove","lines":["\t"]}]}],[{"group":"doc","deltas":[{"start":{"row":146,"column":29},"end":{"row":147,"column":0},"action":"remove","lines":["",""]}]}],[{"group":"doc","deltas":[{"start":{"row":148,"column":27},"end":{"row":149,"column":0},"action":"insert","lines":["",""]},{"start":{"row":149,"column":0},"end":{"row":149,"column":3},"action":"insert","lines":["\t\t\t"]}]}],[{"group":"doc","deltas":[{"start":{"row":149,"column":3},"end":{"row":149,"column":20},"action":"insert","lines":["myUnicorn.fire();"]}]}],[{"group":"doc","deltas":[{"start":{"row":149,"column":3},"end":{"row":149,"column":4},"action":"insert","lines":["\t"]}]}]]},"ace":{"folds":[],"scrolltop":2132,"scrollleft":0,"selection":{"start":{"row":149,"column":21},"end":{"row":149,"column":21},"isBackwards":false},"options":{"guessTabSize":true,"useWrapMode":false,"wrapToView":true},"firstLineState":{"row":132,"state":"start","mode":"ace/mode/javascript"}},"timestamp":1426551950235}